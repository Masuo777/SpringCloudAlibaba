## 引言

### 服务雪崩

分布式环境中，服务间依赖复杂，常常存在A服务依赖B服务，B服务又依赖C服务，等等递归依赖。

此时当底层服务出现问题时，会有大量的请求被阻塞，占用系统资源，最终导致资源耗尽，这种请求会延调用链向上传递，最终导致服务雪崩。



常见服务崩溃原因

- 硬件故障：断网断电，宕机
- 流量激增
- 缓存穿透
- 程序BUG
- 同步等待

常见应对策略

- 硬件层面：多机房，异地存活
- 流量激增：流量控制（限流）、服务自动扩容
- 缓存穿透：
- 同步等待：异步支持、消息队列、解耦



综上所述，如果一个应用不能对来自依赖的故障进行隔离，那该应用本身就处在被拖垮的风险中。因此，为了构建稳定、可靠的分布式系统，我们的服务应当具有自我保护能力，当依赖服务不可用时，当前服务启动自我保护功能，从而避免发生雪崩效应。



# Hystrix







## 简介

Hystrix，英译中：豪猪，所以Hystrix也称豪猪哥，因为豪猪拥有自我保护能力。

断路器，是一个用于处理分布式系统的延迟和容错的开源库，在分布式系统里，许多服务会不可避免地调用失败，比如超市、异常等，Hystrix能保证在一个服务出问题的情况下，不会导致整体服务失败，避免级联故障，提高分布式系统的弹性。



详细讲解可参考如下链接：https://zhuanlan.zhihu.com/p/143981937 



## Hystrix容错



### 服务降级






### 服务熔断

断路器：类似现实中的保险丝，当某个服务发生故障后，通过断路器的故障监控，像调用方返回一个符合预期的、可处理的预备响应（FallBack），而不是长时间的等待或者抛出调用方无法处理的异常，这样就保证了服务调用方的线程不会被长时间、不必要的占用，从而避免了故障在分布式系统中的蔓延，乃至服务雪崩。



### 服务限流











